flowchart TD
    %% Map Viewing Dashboard - Navigation Hub
    
    Start([üëÅÔ∏è Map Viewing]) --> MapViewingDashboard[üó∫Ô∏è Map Viewing Dashboard]
    MapViewingDashboard --> LoadMap[üó∫Ô∏è Load Map Interface]
    LoadMap --> MapLoaded{Map Loaded?}
    MapLoaded -->|No| MapError[‚ùå Map Loading Error]
    MapLoaded -->|Yes| MapInterface[üó∫Ô∏è Interactive Map Interface]
    
    MapInterface --> ViewingOptions{Select Viewing Option}
    
    %% Navigate to specific modules
    ViewingOptions --> MapNavigationFlow[Go to Map Navigation]
    ViewingOptions --> MapLayersFlow[Go to Map Layers]
    ViewingOptions --> MapSearchFlow[Go to Map Search]
    ViewingOptions --> ViewAllLocations[üìç View All Locations]
    
    %% Quick Map Actions (kept here for immediate access)
    ViewingOptions --> QuickZoom[üîç Quick Zoom Controls]
    ViewingOptions --> CurrentLocation[üìç Go to Current Location]
    
    ViewAllLocations --> DisplayAllMarkers[üìç Display All Markers]
    DisplayAllMarkers --> MarkerInteraction{Marker Interaction}
    MarkerInteraction --> ViewMarkerDetails[üëÅÔ∏è View Details]
    MarkerInteraction --> GetDirections[üß≠ Get Directions]
    MarkerInteraction --> ShareLocation[üì§ Share Location]
    
    ViewMarkerDetails --> MarkerPopup[üìã Marker Information Popup]
    MarkerPopup --> ClosePopup[‚ùå Close Popup]
    
    QuickZoom --> ZoomControls[üîç Zoom In/Out/Fit]
    CurrentLocation --> LocationFound[üìç Location Found]
    
    %% Return paths
    MapNavigationFlow --> MapInterface
    MapLayersFlow --> MapInterface
    MapSearchFlow --> MapInterface
    ClosePopup --> DisplayAllMarkers
    GetDirections --> DisplayAllMarkers
    ShareLocation --> DisplayAllMarkers
    DisplayAllMarkers --> MapInterface
    ZoomControls --> MapInterface
    LocationFound --> MapInterface
    MapError --> Start
    
    %% Back to main dashboard
    MapInterface --> Dashboard[üè† Back to Spot Map Dashboard]
    
    %% Styling
    classDef startEnd fill:#e1f5fe,stroke:#01579b,stroke-width:2px,color:#000
    classDef process fill:#f3e5f5,stroke:#4a148c,stroke-width:2px,color:#000
    classDef decision fill:#fff3e0,stroke:#e65100,stroke-width:2px,color:#000
    classDef navigation fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px,color:#000
    classDef error fill:#ffebee,stroke:#c62828,stroke-width:2px,color:#000
    classDef quick fill:#fff8e1,stroke:#f57f17,stroke-width:2px,color:#000
    
    class Start,Dashboard,MapViewingDashboard startEnd
    class LoadMap,MapInterface,ViewAllLocations,DisplayAllMarkers,ViewMarkerDetails,GetDirections,ShareLocation,MarkerPopup process
    class MapLoaded,ViewingOptions,MarkerInteraction decision
    class MapNavigationFlow,MapLayersFlow,MapSearchFlow navigation
    class MapError error
    class QuickZoom,CurrentLocation,ZoomControls,LocationFound quick
